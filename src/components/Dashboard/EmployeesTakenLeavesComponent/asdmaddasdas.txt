import React, { useEffect } from "react";
import { useAppSelector } from "../../../ReduxHooks";
import { useLazyQuery } from "@apollo/client";
import { show_logged_in_employees_leave_details_data_query } from "../../../GraphQLQueries/HomeQuery";
import NavBar from "../../NavBarComponent/NavBar";


import "../EmployeesTakenLeavesComponent/EmployeeTakenLeave.css"

function EmployeesTakenLeaves() {
    const savedEmployeeLoggedInUid = useAppSelector((state) => state.LocalStorageSlicer.loggedInSavedUid);

    const [showLoggedInEmployeesLeaveDetails, { data: showLoggedInEmployeesLeaveDetailsData, loading }] = useLazyQuery(
        show_logged_in_employees_leave_details_data_query,
        {
            variables: {
                showLoggedInEmployeesLeaveDetailsDataParameters: {
                    uid: savedEmployeeLoggedInUid
                },
            },
            onCompleted: (data) => {
                console.log(data);
            },
        }
    );

    useEffect(() => {
        if (savedEmployeeLoggedInUid) {
            showLoggedInEmployeesLeaveDetails();
        }
    }, [savedEmployeeLoggedInUid, showLoggedInEmployeesLeaveDetails]);

    return (
        <div id="main-page" className="show-all-employees-component">
            <NavBar />
            <p className="font-bold">MY APPLIED LEAVES</p>
            {
                showLoggedInEmployeesLeaveDetailsData && showLoggedInEmployeesLeaveDetailsData.showLoggedInEmployeesLeaveDetailsData && showLoggedInEmployeesLeaveDetailsData.showLoggedInEmployeesLeaveDetailsData.map((val: any) => (
                    <div className="show-logged-in-employees-leave-details" key={val.id}>
                        <br></br>
                        <table>
                        <p className="font-semibold">Name: {val.employeeName}</p>
                        <p className="font-semibold">Reason: {val.leaveReason}</p>
                        <p className="font-semibold">Date: {val.date}</p>
                        <div>
                            <p className="font-semibold leave-pending-status">Pending ...</p>
                        </div>

                        </table>
                    </div>

                ))
            }
        </div>
    );
}

export default EmployeesTakenLeaves;
